<!--ç”µå·¥ç«¯ä¸ªäººä¸­å¿ƒé¡µé¢-->
<view class="profile-container">
  <!-- åŠ è½½çŠ¶æ€ -->
  <view wx:if="{{loading}}" class="loading-container">
    <view class="loading-spinner"></view>
    <text class="loading-text">åŠ è½½ä¸­...</text>
  </view>

  <!-- ä¸»è¦å†…å®¹ -->
  <view wx:else class="profile-content">
    <!-- ç”µå·¥ä¿¡æ¯å¡ç‰‡ -->
    <view class="electrician-info-card">
      <view class="info-header">
        <view class="avatar-container" bindtap="onChooseAvatar">
          <image class="avatar" src="{{electricianInfo.avatar || '/images/default-avatar.png'}}" mode="aspectFill"></image>
          <view class="avatar-edit-icon">ğŸ“·</view>
        </view>
        <view class="info-content">
          <view class="name-row">
            <text class="name">{{electricianInfo.name || 'æœªè®¾ç½®å§“å'}}</text>
            <view class="status-badge status-{{electricianInfo.status}}">
              <text class="status-text">{{electricianInfo.statusText}}</text>
            </view>
          </view>
          <view class="phone">{{electricianInfo.phone || 'æœªç»‘å®šæ‰‹æœº'}}</view>
          <view class="level-row">
            <text class="level">{{electricianInfo.levelText}}</text>
            <view class="rating">
              <text class="rating-score">{{electricianInfo.rating}}</text>
              <text class="rating-star">â­</text>
            </view>
          </view>
          <view class="service-area">æœåŠ¡åŒºåŸŸï¼š{{electricianInfo.serviceArea || 'æœªè®¾ç½®'}}</view>
        </view>
      </view>
      
      <!-- è®¤è¯ä¿¡æ¯ -->
      <view class="certification-info">
        <view class="cert-item">
          <text class="cert-label">èº«ä»½è®¤è¯</text>
          <text class="cert-status cert-{{electricianInfo.idVerified ? 'verified' : 'unverified'}}">{{electricianInfo.idVerified ? 'å·²è®¤è¯' : 'æœªè®¤è¯'}}</text>
        </view>
        <view class="cert-item">
          <text class="cert-label">æŠ€èƒ½è®¤è¯</text>
          <text class="cert-status cert-{{electricianInfo.skillVerified ? 'verified' : 'unverified'}}">{{electricianInfo.skillVerified ? 'å·²è®¤è¯' : 'æœªè®¤è¯'}}</text>
        </view>
      </view>
    </view>

    <!-- ç”µå·¥ç»Ÿè®¡ -->
    <view class="electrician-stats">
      <view class="stat-item" bindtap="onViewOrders" data-status="all">
        <text class="stat-number">{{electricianStats.totalOrders}}</text>
        <text class="stat-label">æ€»å·¥å•</text>
      </view>
      <view class="stat-item" bindtap="onViewOrders" data-status="completed">
        <text class="stat-number">{{electricianStats.completedOrders}}</text>
        <text class="stat-label">å·²å®Œæˆ</text>
      </view>
      <view class="stat-item" bindtap="onViewEarnings">
        <text class="stat-number">Â¥{{electricianStats.totalEarnings}}</text>
        <text class="stat-label">æ€»æ”¶ç›Š</text>
      </view>
      <view class="stat-item" bindtap="onViewEarnings">
        <text class="stat-number">Â¥{{electricianStats.monthEarnings}}</text>
        <text class="stat-label">æœ¬æœˆæ”¶ç›Š</text>
      </view>
    </view>

    <!-- å¿«æ·æ“ä½œ -->
    <view class="quick-actions">
      <view class="action-item" bindtap="onViewOrders" data-status="accepted">
        <view class="action-icon">ğŸ“‹</view>
        <text class="action-text">å¾…æœåŠ¡</text>
        <view wx:if="{{electricianStats.acceptedOrders > 0}}" class="action-badge">{{electricianStats.acceptedOrders}}</view>
      </view>
      <view class="action-item" bindtap="onViewOrders" data-status="in_progress">
        <view class="action-icon">ğŸ”§</view>
        <text class="action-text">è¿›è¡Œä¸­</text>
        <view wx:if="{{electricianStats.inProgressOrders > 0}}" class="action-badge">{{electricianStats.inProgressOrders}}</view>
      </view>
      <view class="action-item" bindtap="onViewEarnings">
        <view class="action-icon">ğŸ’°</view>
        <text class="action-text">æ”¶ç›Šç»Ÿè®¡</text>
      </view>
      <view class="action-item" bindtap="onViewDashboard">
        <view class="action-icon">ğŸ </view>
        <text class="action-text">å·¥å•å¤§å…</text>
      </view>
    </view>

    <!-- ä¸šåŠ¡ç®¡ç† -->
    <view class="menu-section">
      <view class="section-title">ä¸šåŠ¡ç®¡ç†</view>
      <view class="menu-list">
        <view class="menu-item" bindtap="onViewOrders">
          <view class="menu-icon">ğŸ“</view>
          <text class="menu-text">æˆ‘çš„å·¥å•</text>
          <text class="menu-arrow">â€º</text>
        </view>
        <view class="menu-item" bindtap="onViewEarnings">
          <view class="menu-icon">ğŸ“Š</view>
          <text class="menu-text">æ”¶ç›Šç»Ÿè®¡</text>
          <text class="menu-arrow">â€º</text>
        </view>
        <view class="menu-item" bindtap="onViewCustomers">
          <view class="menu-icon">ğŸ‘¥</view>
          <text class="menu-text">å®¢æˆ·ç®¡ç†</text>
          <text class="menu-arrow">â€º</text>
        </view>
        <view class="menu-item" bindtap="onViewSchedule">
          <view class="menu-icon">ğŸ“…</view>
          <text class="menu-text">æœåŠ¡æ—¥ç¨‹</text>
          <text class="menu-arrow">â€º</text>
        </view>
      </view>
    </view>

    <!-- æœåŠ¡ç®¡ç† -->
    <view class="menu-section">
      <view class="section-title">æœåŠ¡ç®¡ç†</view>
      <view class="menu-list">
        <view class="menu-item" bindtap="onManageServices">
          <view class="menu-icon">âš¡</view>
          <text class="menu-text">æœåŠ¡é¡¹ç›®</text>
          <text class="menu-arrow">â€º</text>
        </view>
        <view class="menu-item" bindtap="onManageArea">
          <view class="menu-icon">ğŸ“</view>
          <text class="menu-text">æœåŠ¡åŒºåŸŸ</text>
          <text class="menu-arrow">â€º</text>
        </view>
        <view class="menu-item" bindtap="onManagePrice">
          <view class="menu-icon">ğŸ’µ</view>
          <text class="menu-text">ä»·æ ¼è®¾ç½®</text>
          <text class="menu-arrow">â€º</text>
        </view>
        <view class="menu-item" bindtap="onViewReviews">
          <view class="menu-icon">â­</view>
          <text class="menu-text">å®¢æˆ·è¯„ä»·</text>
          <text class="menu-arrow">â€º</text>
        </view>
      </view>
    </view>

    <!-- å·¥å…·ä¸å¸®åŠ© -->
    <view class="menu-section">
      <view class="section-title">å·¥å…·ä¸å¸®åŠ©</view>
      <view class="menu-list">
        <view class="menu-item" bindtap="onViewCertification">
          <view class="menu-icon">ğŸ“</view>
          <text class="menu-text">è®¤è¯ä¸­å¿ƒ</text>
          <view wx:if="{{!electricianInfo.idVerified || !electricianInfo.skillVerified}}" class="menu-badge">!</view>
          <text class="menu-arrow">â€º</text>
        </view>
        <view class="menu-item" bindtap="onContactSupport">
          <view class="menu-icon">ğŸ’¬</view>
          <text class="menu-text">è”ç³»å®¢æœ</text>
          <text class="menu-arrow">â€º</text>
        </view>
        <view class="menu-item" bindtap="onViewHelp">
          <view class="menu-icon">â“</view>
          <text class="menu-text">å¸®åŠ©ä¸­å¿ƒ</text>
          <text class="menu-arrow">â€º</text>
        </view>
        <view class="menu-item" bindtap="onViewAgreement">
          <view class="menu-icon">ğŸ“„</view>
          <text class="menu-text">æœåŠ¡åè®®</text>
          <text class="menu-arrow">â€º</text>
        </view>
      </view>
    </view>

    <!-- è®¾ç½® -->
    <view class="menu-section">
      <view class="section-title">è®¾ç½®</view>
      <view class="menu-list">
        <view class="menu-item" bindtap="onAccountSettings">
          <view class="menu-icon">âš™ï¸</view>
          <text class="menu-text">è´¦æˆ·è®¾ç½®</text>
          <text class="menu-arrow">â€º</text>
        </view>
        <view class="menu-item" bindtap="onNotificationSettings">
          <view class="menu-icon">ğŸ””</view>
          <text class="menu-text">æ¶ˆæ¯é€šçŸ¥</text>
          <text class="menu-arrow">â€º</text>
        </view>
        <view class="menu-item" bindtap="onPrivacySettings">
          <view class="menu-icon">ğŸ”’</view>
          <text class="menu-text">éšç§è®¾ç½®</text>
          <text class="menu-arrow">â€º</text>
        </view>
        <view class="menu-item" bindtap="onAbout">
          <view class="menu-icon">â„¹ï¸</view>
          <text class="menu-text">å…³äºæˆ‘ä»¬</text>
          <text class="menu-arrow">â€º</text>
        </view>
      </view>
    </view>

    <!-- è§’è‰²åˆ‡æ¢ -->
    <view class="role-switch">
      <view class="switch-item" bindtap="onSwitchToUser">
        <view class="switch-icon">ğŸ‘¤</view>
        <view class="switch-content">
          <text class="switch-title">åˆ‡æ¢åˆ°ç”¨æˆ·ç«¯</text>
          <text class="switch-desc">ä½“éªŒä¸‹å•æœåŠ¡</text>
        </view>
        <text class="switch-arrow">â€º</text>
      </view>
    </view>

    <!-- é€€å‡ºç™»å½• -->
    <view class="logout-section">
      <view class="logout-btn" bindtap="onLogout">
        <text class="logout-text">é€€å‡ºç™»å½•</text>
      </view>
    </view>
  </view>

  <!-- å¤´åƒé€‰æ‹©å¼¹çª— -->
  <view wx:if="{{showAvatarModal}}" class="avatar-modal" bindtap="onCloseAvatarModal">
    <view class="avatar-modal-content" catchtap="">
      <view class="modal-title">é€‰æ‹©å¤´åƒ</view>
      <view class="avatar-options">
        <view class="avatar-option" bindtap="onChooseFromAlbum">
          <view class="option-icon">ğŸ“·</view>
          <text class="option-text">ä»ç›¸å†Œé€‰æ‹©</text>
        </view>
        <view class="avatar-option" bindtap="onTakePhoto">
          <view class="option-icon">ğŸ“¸</view>
          <text class="option-text">æ‹ç…§</text>
        </view>
      </view>
      <view class="modal-cancel" bindtap="onCloseAvatarModal">å–æ¶ˆ</view>
    </view>
  </view>
</view>